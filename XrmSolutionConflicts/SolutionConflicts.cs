using System;
using System.Collections.Generic;
using System.ComponentModel.Composition;
using System.IO;
using System.Linq;
using System.Reflection;
using XrmToolBox.Extensibility;
using XrmToolBox.Extensibility.Interfaces;

namespace XrmSolutionConflicts
{
    // Do not forget to update version number and author (company attribute) in AssemblyInfo.cs class
    // To generate Base64 string for Images below, you can use https://www.base64-image.de/
    [Export(typeof(IXrmToolBoxPlugin)),
        ExportMetadata("Name", "Solution Conflicts Viewer"),
        ExportMetadata("Description", "Lists the component conflicts from a solution"),
        // Please specify the base64 content of a 32x32 pixels image
        ExportMetadata("SmallImageBase64", "data:image/png;base64,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"),
        // Please specify the base64 content of a 80x80 pixels image
        ExportMetadata("BigImageBase64", "data:image/png;base64,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"),
        ExportMetadata("BackgroundColor", "Lavender"),
        ExportMetadata("PrimaryFontColor", "Black"),
        ExportMetadata("SecondaryFontColor", "Gray")]
    public class SolutionConflicts : PluginBase
    {
        public override IXrmToolBoxPluginControl GetControl()
        {
            return new SolutionConflictsControl();
        }

        /// <summary>
        /// Constructor 
        /// </summary>
        public SolutionConflicts()
        {
            // If you have external assemblies that you need to load, uncomment the following to 
            // hook into the event that will fire when an Assembly fails to resolve
            // AppDomain.CurrentDomain.AssemblyResolve += new ResolveEventHandler(AssemblyResolveEventHandler);
        }

        /// <summary>
        /// Event fired by CLR when an assembly reference fails to load
        /// Assumes that related assemblies will be loaded from a subfolder named the same as the Plugin
        /// For example, a folder named Sample.XrmToolBox.MyPlugin 
        /// </summary>
        /// <param name="sender"></param>
        /// <param name="args"></param>
        /// <returns></returns>
        private Assembly AssemblyResolveEventHandler(object sender, ResolveEventArgs args)
        {
            Assembly loadAssembly = null;
            Assembly currAssembly = Assembly.GetExecutingAssembly();

            // base name of the assembly that failed to resolve
            var argName = args.Name.Substring(0, args.Name.IndexOf(","));

            // check to see if the failing assembly is one that we reference.
            List<AssemblyName> refAssemblies = currAssembly.GetReferencedAssemblies().ToList();
            var refAssembly = refAssemblies.Where(a => a.Name == argName).FirstOrDefault();

            // if the current unresolved assembly is referenced by our plugin, attempt to load
            if (refAssembly != null)
            {
                // load from the path to this plugin assembly, not host executable
                string dir = Path.GetDirectoryName(currAssembly.Location).ToLower();
                string folder = Path.GetFileNameWithoutExtension(currAssembly.Location);
                dir = Path.Combine(dir, folder);

                var assmbPath = Path.Combine(dir, $"{argName}.dll");

                if (File.Exists(assmbPath))
                {
                    loadAssembly = Assembly.LoadFrom(assmbPath);
                }
                else
                {
                    throw new FileNotFoundException($"Unable to locate dependency: {assmbPath}");
                }
            }

            return loadAssembly;
        }
    }
}